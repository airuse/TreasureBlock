# 扫块收益页面更新说明

## 更新概述

根据用户需求，对扫块收益页面进行了以下主要更新：

### 1. 收益概览区域更新
- **总收益** → **当前余额**：显示用户当前的T币余额
- **本月收益** → **总扫块交易数**：显示用户累计扫块的交易总数（来自 `EarningsStats.transaction_count`）

### 2. 收益趋势图表
- 将原来的占位图表替换为**近2小时收益趋势折线图**
- 使用SVG技术实现，不依赖外部图表库
- 自动过滤近2小时内的收益记录（`type === 'add'`）
- 按时间顺序展示收益变化趋势
- 包含网格线、区域填充、数据点和时间标签

### 3. 收益记录列表字段优化
根据后端API返回的实际数据结构，更新了表格字段：

| 字段 | 说明 | 数据来源 |
|------|------|----------|
| 时间 | 收益记录创建时间 | `created_at` |
| 区块高度 | 相关区块高度 | `block_height` |
| 交易数量 | 区块中的交易数量 | `transaction_count` |
| 收益 (TB) | 获得的T币数量 | `amount` |
| 余额变化 | 操作前后的余额对比 | `balance_before` → `balance_after` |
| 操作 | 查看区块详情 | 跳转到区块详情页面 |

### 4. 数据结构更新
- 更新了Mock数据，使其与后端API返回的数据结构一致
- 修复了TypeScript类型定义问题
- 移除了不再使用的状态相关字段和函数

### 5. 图表功能特性
- **响应式设计**：图表自动适应容器大小
- **数据过滤**：只显示近2小时内的收益数据
- **视觉优化**：包含渐变填充、网格线、数据点标记
- **空数据处理**：当没有数据时显示友好的提示信息

## 技术实现

### SVG图表实现
- 使用原生SVG技术，无需额外依赖
- 支持动态数据绑定和实时更新
- 包含完整的图表元素：折线、区域填充、网格线、标签

### 数据加载流程
1. 加载用户余额和统计数据
2. 加载收益记录列表
3. 数据加载完成后自动创建趋势图表
4. 支持分页和时间周期筛选

### 类型安全
- 完整的TypeScript类型定义
- 与后端API数据结构完全匹配
- 编译时类型检查确保代码质量

## 使用说明

### 查看收益概览
- 当前余额：显示用户实时的T币余额
- 今日收益：显示今日获得的T币数量
- 总扫块交易数：显示累计扫块的交易总数

### 查看收益趋势
- 图表自动显示近2小时的收益变化
- 横轴为时间，纵轴为收益数量
- 支持鼠标悬停查看具体数值

### 查看收益记录
- 支持分页浏览
- 可按时间周期筛选（7天、30天、90天）
- 每条记录显示完整的收益信息

## 注意事项

1. **图表更新**：每次加载新数据后会自动更新趋势图表
2. **数据过滤**：趋势图表只显示类型为"add"的收益记录
3. **时间显示**：所有时间都使用本地时区显示
4. **响应式**：页面支持不同屏幕尺寸的显示

## 后续优化建议

1. **图表交互**：添加图表缩放、拖拽等交互功能
2. **数据导出**：支持收益数据导出为CSV/Excel
3. **实时更新**：通过WebSocket实现收益数据的实时更新
4. **更多图表**：添加日、周、月等不同时间维度的图表
